<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/tailwind-output.css}" />
    <title>Video Page</title>
</head>
<body>

<div class="flex flex-col min-h-dvh">


<header class="flex items-center justify-between bg-background px-4 py-3 shadow-sm sm:px-6">
    <div class="flex items-center gap-4 md:gap-10 ">
        <a class="flex items-center gap-2" th:href="@{/home}" rel="ugc">
            <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-6 w-6 text-red-500"
            >
                <path d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17"></path>
                <path d="m10 15 5-3-5-3z"></path>
            </svg>
            <span class="text-lg font-bold">Truth Lens</span>
        </a>
        <form class="relative flex-1"  th:action="@{/search}" method="get">
            <div class="absolute inset-y-0 left-2 flex items-center">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="h-4 w-4 text-muted-foreground"
                >
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.3-4.3"></path>
                </svg>
            </div>
            <input
                    class="flex h-10 border border-input px-3 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 w-full rounded-full bg-muted pl-8 pr-4 py-2 text-sm focus:outline-none focus:ring-1 focus:ring-primary"
                    placeholder="Search"
                    type="search"
                    name="query"
            />
        </form>
    </div>
    <div class="flex flex-row items-center gap-10">
        <a th:href="@{/fact-check-video}" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-full">
            <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-5 w-5"
            >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" x2="12" y1="3" y2="15"></line>
            </svg>
            <span class="sr-only">Upload</span>
        </a>

        <button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-full">
            <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="h-5 w-5"
            >
                <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
            </svg>
            <span class="sr-only">Notifications</span>
        </button>
        <button
                class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10 rounded-full"
                type="button"
                id="radix-:r2:"
                aria-haspopup="menu"
                aria-expanded="false"
                data-state="closed"
        >
            <img
                    src="/placeholder.svg"
                    width="32"
                    height="32"
                    alt="Avatar"
                    class="rounded-full"
                    style="aspect-ratio: 32 / 32; object-fit: cover;"
            />
            <span class="sr-only">User menu</span>
        </button>
    </div>
</header>


<div class="grid grid-cols-1 md:grid-cols-[3fr_1fr] gap-6 p-4 md:p-6">
    <div class="rounded-lg overflow-hidden">
        <video
                class="w-full aspect-video"
                controls=""
                th:src="@{'/videos-storage/' + ${video.fileName}}"
        ></video>

        <div>
            <h1 class="text-2xl font-bold" th:text="${video.fileName}">Video Title</h1>
            <p class="text-muted-foreground" th:text="${video.transcriptionText}">
                Video transcription text goes here.
            </p>
            <div class="flex items-center gap-4 mt-4 text-sm text-muted-foreground">
                <div th:text="${#temporals.format(video.processedAt, 'HH:mm')}">12:34</div>
                <div>Uploaded by: <span th:text="${video.user.username}">Username</span></div>
                <div th:text="${#temporals.format(video.processedAt, 'dd MMM yyyy')}">2 days ago</div>
            </div>

            <div class="flex flex-col gap-4 mt-4">

                <div class="flex items-center space-x-4 w-full">
                    <div class="relative w-full h-4 bg-gray-200 rounded-full overflow-hidden">
                        <div id="progressBar"
                             class="h-full rounded-full transition-all duration-300 ease-in-out"
                             th:style="'width: ' + ${video.factPercentage} + '%; background-color: ' + ${
           video.factPercentage < 33 ? 'rgb(239, 68, 68)' :
           (video.factPercentage < 66 ? 'rgb(234, 179, 8)' : 'rgb(34, 197, 94)')
         }"
                        ></div>
                    </div>
                    <span id="percentageValue" class="text-lg font-semibold" th:text="${video.factPercentage != null ? #numbers.formatDecimal(video.factPercentage, 1, 1) + '%' : 'Failed to analyze video'}"></span>

                </div>

                <h3 class="font-bold text-muted-foreground">False Statements</h3>
                <div th:if="${not #lists.isEmpty(video.falseStatements)}">
                    <ul th:each="falseStatement: ${video.falseStatements}">
                        <li class="flex gap-4 items-center">
                            <p>
                                <span class="text-muted-foreground" th:text="${falseStatement}">Text</span>
                            </p>
                        </li>
                    </ul>
                </div>
                <div th:unless="${not #lists.isEmpty(video.falseStatements)}" class="text-muted-foreground italic">
                    No false statements found for this video.
                </div>
            </div>
        </div>

    </div>

    <div>
        <h2 class="text-lg font-semibold mb-4">Related Videos</h2>
        <div class="grid gap-4">
            <!-- Loop over relatedVideos -->
            <div th:each="relatedVideo : ${relatedVideos}" class="flex gap-4">
                <a th:href="@{/videos/{id}(id=${relatedVideo.id})}" class="flex items-center gap-2">

                <img
                        th:src="@{'/thumbnails/' + ${relatedVideo.thumbnailPath}}"
                        width="120"
                        height="80"
                        alt="Thumbnail"
                        class="rounded-md object-cover"
                        style="aspect-ratio: 120 / 80; object-fit: cover;"
                />
                <div>
                    <h3 class="font-medium line-clamp-2" th:text="${relatedVideo.fileName}">Related Video Title</h3>
                    <div class="text-sm text-muted-foreground" th:text="${randomNum}">Views count</div>
                </div>
                </a>
            </div>
        </div>
    </div>
</div>
</div>

<footer class="bg-background border-t px-4 lg:px-6 py-6 flex items-center justify-between">
    <div class="text-xs text-muted-foreground">Â© <span th:text="${#dates.year(#dates.createNow())}"></span> Fact Checker. All rights reserved.</div>
    <nav class="flex items-center gap-4">
        <a class="text-xs hover:underline" th:href="@{/about}">
            About
        </a>
        <!-- Vertical divider -->
        <div data-orientation="vertical" role="none" class="shrink-0 bg-border w-[1px] h-4"></div>
        <a class="text-xs hover:underline" th:href="@{/terms}">
            Terms
        </a>
        <!-- Vertical divider -->
        <div data-orientation="vertical" role="none" class="shrink-0 bg-border w-[1px] h-4"></div>
        <a class="text-xs hover:underline" th:href="@{/privacy}">
            Privacy
        </a>
    </nav>
</footer>
</div>
</body>
</html>
